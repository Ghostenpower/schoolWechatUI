<view class="chat-container">
  <!-- 聊天记录 -->
  <scroll-view 
    class="chat-list" 
    scroll-y="true" 
    scroll-into-view="{{scrollIntoView}}"
    bindscrolltoupper="onScrollToUpper"
  >
    <view 
      class="chat-item {{item.senderId === userId ? 'self' : ''}}"
      wx:for="{{messages}}"
      wx:key="timestamp"
      id="msg-{{index}}"
    >
      <image 
        class="avatar" 
        src="{{item.senderId === userId ? userInfo.avatarUrl : targetInfo.avatarUrl || '/static/default-avatar.png'}}"
      />
      <view class="message-content">
        <view class="nickname">{{item.senderId === userId ? userInfo.username : targetInfo.username || '对方'}}</view>
        <view class="message-bubble">{{item.content}}</view>
        <view class="time">{{item.timeStr}}</view>
      </view>
    </view>
  </scroll-view>

  <!-- 输入框区域 -->
  <view class="input-area">
    <input 
      class="message-input"
      type="text"
      value="{{inputMessage}}"
      placeholder="请输入消息"
      bindinput="onInputMessage"
      bindconfirm="sendMessage"
      confirm-type="send"
    />
    <button 
      class="send-btn {{inputMessage.trim() ? '' : 'disabled'}}" 
      bindtap="sendMessage"
      disabled="{{!inputMessage}}"
    >发送</button>
  </view>
</view> 